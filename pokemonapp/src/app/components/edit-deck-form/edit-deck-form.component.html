<div class="p-8" *ngIf="dataSource.data.length > 1">
  <div class="grid grid-cols-3">
    <div class="p-0">
      <form [formGroup]="form">
        <mat-form-field>
          <input matInput placeholder="Name of Deck" id="name" formControlName="name" type="text">
          <mat-error
            *ngIf="(form.get('name')?.dirty)
            && form.get('name')?.hasError('required')">
            The field shouldn't be empty!
          </mat-error>
          <mat-error
            *ngIf="(form.get('name')?.dirty)
            && form.get('name')?.hasError('minlength')">
            The min of characters is 3!
          </mat-error>
        </mat-form-field>
        <button
          mat-raised-button
          color="primary"
          [disabled]="!form.valid || numberOfCardsOnDeck < 24"
          (click)="editDeck()"
          class="ml-3 cursor-pointer"
          >Edit Deck</button>
      </form>
      <div class="p-0">
        Number of Cards on Deck (<span class="text-red-600">{{numberOfCardsOnDeck}}</span>)
      </div>
    </div>
  </div>

  <div class="grid grid-cols-1">
    <mat-form-field>
      <mat-label>Filter</mat-label>
      <input matInput (keyup)="applyFilter($event)" placeholder="Filter" #input>
    </mat-form-field>
    <table mat-table [dataSource]="dataSource" class="mat-elevation-z8 w-full">
      <!-- Image Column -->
      <ng-container matColumnDef="images">
        <th mat-header-cell *matHeaderCellDef> Image </th>
        <td mat-cell *matCellDef="let element">
          <img class="rounded-full w-10 h-10" src="{{element.images.small}}" alt="{{element.name}}">
        </td>
      </ng-container>
      <!-- Name Column -->
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef> Name </th>
        <td mat-cell *matCellDef="let element"> {{element.name}} </td>
      </ng-container>
      <!-- Super Type Column -->
      <ng-container matColumnDef="supertype">
        <th mat-header-cell *matHeaderCellDef> Super Type </th>
        <td mat-cell *matCellDef="let element"> {{element.supertype}} </td>
      </ng-container>
      <!-- Level Column -->
      <ng-container matColumnDef="level">
        <th mat-header-cell *matHeaderCellDef> Level </th>
        <td mat-cell *matCellDef="let element"> {{element.level}} </td>
      </ng-container>
      <!-- HP Column -->
      <ng-container matColumnDef="hp">
        <th mat-header-cell *matHeaderCellDef> HP </th>
        <td mat-cell *matCellDef="let element"> {{element.hp}} </td>
      </ng-container>
      <!-- Rarity Column -->
      <ng-container matColumnDef="rarity">
        <th mat-header-cell *matHeaderCellDef> Rarity </th>
        <td mat-cell *matCellDef="let element"> {{element.rarity}} </td>
      </ng-container>
      <!-- Rarity Column -->
      <ng-container matColumnDef="select">
        <th mat-header-cell *matHeaderCellDef> Select </th>
        <td mat-cell *matCellDef="let element">
          <button mat-button class="justify-items-center cursor-pointer" (click)="addCardToDeck(element)" [disabled]="numberOfCardsOnDeck >= 60 && !element.isCardSelected">
            <mat-icon *ngIf="!element.isCardSelected" [ngClass]="numberOfCardsOnDeck >= 60 ? 'text-grey' : 'text-green-500'">add_circle</mat-icon>
            <mat-icon *ngIf="element.isCardSelected" class="text-red-600">remove_circle</mat-icon>
          </button>
        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
  </div>
  <mat-dialog-actions align="end">
    <button
      mat-raised-button
      color="primary"
      mat-dialog-close>
        Close
    </button>
  </mat-dialog-actions>
</div>

<!-- loader -->
<div *ngIf="isLoading" class="flex items-center justify-center h-screen">
  <div class="relative">
      <div class="h-24 w-24 rounded-full border-t-8 border-b-8 border-gray-200"></div>
      <div class="absolute top-0 left-0 h-24 w-24 rounded-full border-t-8 border-b-8 border-blue-500 animate-spin">
      </div>
  </div>
</div>
